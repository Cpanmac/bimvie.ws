<div class="resetpassword container">
    <div class="span7">.
	    <div class="header"></div>
    	<div class="form">
	    	<form class="loginForm form-inline">
		    	<legend>Reset password</legend>
		    	<div class="form-group">
		    		<label class="sr-only">New password</label>
					<input class="password form-control" type="password"/>
		    	</div>
				<button class="btn btn-default resetButton">Reset</button>
			</form>
		</div>
	</div>
</div>
<script>
function ResetPassword(containerDiv, main) {
	var othis = this;

	this.show = function(){
		$(".sidespan").empty();
		Global.bimServerApi.logout(function(){
		});
	};
	
	$(".header").load(Global.baseDir + "header.html");
	
	this.resetPassword = function(event) {
		event.preventDefault();
		var uoid = getParameterByName("uoid");
		var token = getParameterByName("token");
		var password = $(".password").val();
		var address = getParameterByName("address");
		
		loadBimServerApi(address, Global.notifier, function(serverInfo){
			if (serverInfo.serverState == "NOT_SETUP") {
			} else if (serverInfo.serverState == "UNDEFINED") {
			} else if (serverInfo.serverState == "MIGRATION_REQUIRED") {
			} else if (serverInfo.serverState == "MIGRATION_IMPOSSIBLE") {
			} else if (serverInfo.serverState == "FATAL_ERROR") {
			} else if (serverInfo.serverState == "RUNNING") {
				Global.bimServerApi.callWithFullIndication("AuthInterface", "validateAccount", {uoid: uoid, token: token, password: password}, function(){
					window.location = Global.baseDir + "?address=" + address;
				});
			}
		});
	}
	
	containerDiv.find(".resetButton").click(othis.resetPassword);
	containerDiv.find(".password").enterpress(othis.resetPassword);
	
	containerDiv.find(".password").focus();
}
</script>